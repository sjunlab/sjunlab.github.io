# 임베딩 개념정리

## 임베딩이란?

텍스트를 컴퓨터가 이해하고, 효율적으로 처리하기 위해 텍스트를 적절한 숫자로 변환해야한다. 단어를 표현하는 방법에 따라서 자연어 처리의 성능이 크게 달라지기 때문에 단어를 수치화 하기 위한 많은 연구들이 진행중되었다. 현재는 각 단어의 인공 신경망 학습을 통해 벡터화하는 워드 임베딩 방법이 가장 많이 사용된다.

## 워드 임베딩(Word Embedding)

 워드 임베딩(Word Embedding)은 단어를 벡터로 표현하는 방법으로, 단어의 밀집을 표현으로 변환한다. 표현의 종류는 희소 표현, 밀집 표현이 있다.
 
### 1. 희소 표현(Spare Representation)

 희소 표현은 벡터 또는 행렬의 값이 대부분 0으로 표현되는 방법을 희소 표현이라고 한다. 그 대표적인 예로는 원-핫 인코딩을 예로들 수 있다. 원-핫 인코딩은 단어를 인코딩 규칙에 따라 0과 1로 표현하는 방식이다.
 희소 벡터의 문제점은 단어의 개수가 늘어나면 벡터의 차원이 한없이 커진다. 원-핫 벡터로 표현을 할때는 단어의 인덱스에 해당하는 부분만 1이고 나머지는 0값을 가져야만한다. 이러한 문제점은 단어 집합이 클수록 고차원의 벡터가 되어 공간적 낭비를 불러일으킨다. 예를들어 강아지란 단어의 인덱스의 원한 벡터는 이렇게 표현되어야 한다.

Ex) 강아지 = [ 0 0 0 0 1 0 0 0 0 0 0 0 ... 중략 ... 0] # 이때 1 뒤의 0의 수는 9995개

결론적으로 원-핫 벡터와 같은 희소 표현의 문제점은 단어가 0과 1로 구성되어 단어의 의미를 표현하지 못한다.

### 2. 밀집 표현(Dense Representation)

 희소 표현과 반대되는 표현의 밀집표현은 사용자가 설정한 값으로 모든 단어의 벡터 표현의 차원을 맞춘다. 이 과정에서 더 이상 0과 1만 가진 값이 아니라 실수값을 가지게 된다. 예를 들어 희소 표현에서는 강아지라는 단어를 표현하기 위해 많은 공간적 낭비를 유발했다면 밀집 표현에서는 사용자가 지정된 차원에 따라 모든 값이 실수로 변형되어 밀집이 축소된다.

Ex) 강아지 = [0.2 1.8 1.1 -2.1 1.1 2.8 ... 중략 ...] # 이 벡터의 차원은 128

이 경우 벡터의 차원이 조밀해졌다고 하여 밀집 벡터라고 한다.

### 3. 워드 임베딩의 개념(Word Embedding)


 위에서 설명한 단어를 밀집 벡터(dense vector)의 형태로 표현하는 방법을 워드 임베딩이라고 한다. 그리고 밀집 벡터를 워드 임베딩 과정을 통해 나온 결과를 임베딩 벡터(embedding vector)라고 한다. 
 워드 임베딩 방법론에는 LSA, Word2Vec, FastText, Glove 등이 있다. 이 방법들의 공통점은 단어를 랜덤한 값을 가지는 밀집 벡터로 변환한 뒤에, 인공 신경망을 통해 단어에 가중치를 부여하여 학습하는 방식으로 사용한다. 다음은 원-핫 벡터와 임베딩 벡터의 차이이다.

||원-핫 벡터|임베딩 벡터|
|:---:|:-----:|:-----:|
|차원|고차원(단어 집합의 크기)|저차원|
|다른 표현|희소 벡터의 일종|밀집 벡터의 일종|
|표현 방법|수동|훈련 데이터로 학습|
|표현 방법|1 or 0|실수|


## 워드 투 벡터(Word2Vec)

 워드투벡터는 단어 벡터간 유의미한 유사도를 반영할 수 있도록 단어의 의미를 수치화하는 방법이다. 워드투벡터는 앞서 설명한 임베딩 벡터의 단어들을 더하기, 빼기 연산을 할 수 있다. 단어의 연산이 가능한 이유는 임베딩 벡터를 통해 단어를 사용가자 원하는 밀도의 실수 타입으로 표현할 수 있기 때문이다. 예를 들어 아래 식에 좌변을 집어 넣으면, 우변의 답들이 나온다.
 
- 한국 - 서울 + 도쿄 = 일본
- 박찬호 - 야구 + 축구 = 호나우두

 위의 단어들을 보면 의미들을 가지고 연산이 되는 것처럼 보인다. 이러한 연산이 가능한 이유는 벡터간 유사도를 반영한 값을 가지고 있기 때문이다. 이러한 단어의 의미를 공간 벡터화 하는 방법을 분산 표현(distributed representation)이라고 한다.
 
## 분산 표현(Distribute Representation)

 분산표현 방법은 기본적으로 분포 가설(distributional hypothesis)이라는 가정 하에 만들어진 표현 방법이다. 이 가정은 ‘비슷한 문맥에서 등장하는 단어들은 비슷한 의미를 가진다’라는 가정이다. 예를들어, 강아지라는 단어는 귀엽다, 예쁘다, 애교 등의 단어가 주로 함게 등장하는데 분포 가설에 따라서 해당 내용을 가진 텍스트의 단어들을 벡터화한다면 해당 단어 벡터들은 유사한 벡터값을 갖게 된다. 즉, 분산 표현은 분포 가설을 이용하여 텍스트를 학습하고 단어의 의미를 벡터의 여러 차원에 분산하여 표현한다. 분산 표현의 대표적인 학습 방법은 Word2Vec이다. 
